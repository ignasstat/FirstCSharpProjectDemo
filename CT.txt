with RunStatusForJobs AS (
select CT_JobID, RunStatus, MAX(RunNo) as highestrownum
from dbo.CT_JobRun
group by CT_JobID, RunStatus
)

select YT.FileID,
RS.CT_JobID,
RS.highestrownum,
RS.RunStatus
from dbo.CT_JobRun YT 
left join  RunStatusForJobs RS ON RS.CT_JobID = YT.CT_JobID and RS.RunStatus = YT.RunStatus
order by RS.CT_JobID desc
