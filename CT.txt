Function HeaderOnlyFile(myFile As String, HeaderInFirstRow as String) As String
Dim mf As Object
Dim Dummy As String
Dim LineCount As Long

' Nothing to do unless the file exists
If Not fso.FileExists(myFile) Then
  HeaderOnlyFile = "NotFound"
Else
  Set mf = fso.GetFile(myFile)

  If mf.Size > 0 Then
    
    If HeaderInFirstRow = "True" Then
      'ElseIf (Right(myFile, 4) = ".csv" Or Right(myFile, 4) = ".txt") Then
      ' If not empty then need to check how many lines are in it
      Set mf = Nothing
      
      Set mf = fso.OpenTextFile(myFile, ForReading)
      
      LineCount = 0
      
      ' Check if there is anything else in the file
      Do While Not mf.AtEndOfStream And LineCount < 2
      
      Dummy = mf.ReadLine
      LineCount = LineCount + 1
      Loop
      
      If LineCount > 1 Then
        HeaderOnlyFile = "FoundNotEmpty"
        Else
        HeaderOnlyFile = "FoundEmpty"
      End If
      
      mf.Close
      
    Else
      HeaderOnlyFile = "FoundNotEmpty"
    Else
      HeaderOnlyFile = "NotFound"
      ' File is empty
  End If
End If

End Function


	'\\cig.local\Data\Marketing Solutions Departments\Production\Neptune\CallTrace\InTouch\','<InTouch>\')









  'Create a trigger file called by fileID
            Dim Fileout As TextStream
            
            ' Jeigu failas yra po neptune tada faila numetam iskarto i reikiama folderi ir i done
            Set Fileout = fso.CreateTextFile(fileExistsTriggerFullPath, True, True)
            
            'Set trigger content to full file path (first row)
            Fileout.Write strFile
            Fileout.Write vbCrLf
            'Adding new line JobNumber (second row)
            Fileout.Write JobNumber
            Fileout.Write vbCrLf
            'Adding new line HeaderInFirstRow (third row)
            Fileout.Write HeaderInFirstRow
            
            Fileout.Close
            Set Fileout = Nothing
    





Function HeaderOnlyFile(myFile As String, HeaderInFirstRow As String) As String
    Dim fso As Object
    Dim mf As Object
    Dim Dummy As String
    Dim LineCount As Long
    
    Set fso = CreateObject("Scripting.FileSystemObject")

    ' Nothing to do unless the file exists
    If Not fso.FileExists(myFile) Then
        HeaderOnlyFile = "NotFound"
    Else
        Set mf = fso.GetFile(myFile)
        
        If mf.Size > 0 Then
            If HeaderInFirstRow = "True" Then
                ' If not empty, then need to check how many lines are in it
                On Error Resume Next
                Set mf = fso.OpenTextFile(myFile, 1)  ' ForReading (1)
                On Error GoTo 0
                
                If Not mf Is Nothing Then
                    LineCount = 0
                    
                    ' Check if there is anything else in the file
                    Do While Not mf.AtEndOfStream And LineCount < 2
                        Dummy = mf.ReadLine
                        LineCount = LineCount + 1
                    Loop
                    
                    mf.Close
                    
                    If LineCount > 1 Then
                        HeaderOnlyFile = "FoundNotEmpty"
                    Else
                        HeaderOnlyFile = "FoundEmpty"
                    End If
                Else
                    ' Unable to open file
                    HeaderOnlyFile = "ErrorOpeningFile"
                End If
            Else
                HeaderOnlyFile = "FoundNotEmpty"
            End If
        Else
            HeaderOnlyFile = "FoundEmpty"  ' File is empty
        End If
    End If
End Function
