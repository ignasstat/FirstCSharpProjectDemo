# SQL connection details
$server = "YourServer"
$database = "YourDatabase"
$connectionString = "Server=$server;Database=$database;Integrated Security=True;"

# SQL query to retrieve data from the table
$sqlQuery = @"
SELECT [FileID]
      ,[Folder]
      ,[FileName]
      ,[FileExists]
FROM YourTableName
"@

# Create a SQL connection
$sqlConnection = New-Object System.Data.SqlClient.SqlConnection
$sqlConnection.ConnectionString = $connectionString

try {
    $sqlConnection.Open()

    # Create a SQL command
    $sqlCommand = $sqlConnection.CreateCommand()
    $sqlCommand.CommandText = $sqlQuery

    # Create a data adapter
    $dataAdapter = New-Object System.Data.SqlClient.SqlDataAdapter $sqlCommand

    # Create a dataset to store the results
    $dataSet = New-Object System.Data.DataSet

    # Fill the dataset with the results
    $dataAdapter.Fill($dataSet) | Out-Null

    # Specify the path to export the data
    $exportPath = "C:\Path\To\Your\ExportedData.csv"

    # Export the data to a CSV file
    $dataSet.Tables[0] | Export-Csv -Path $exportPath -NoTypeInformation

    Write-Host "Data exported successfully to: $exportPath"

} catch {
    Write-Host "Error: $_"
} finally {
    # Close the SQL connection
    $sqlConnection.Close()
    Write-Host "SQL connection closed."
}









# Specify the path to the exported CSV file
$csvFilePath = "C:\Path\To\Your\ExportedData.csv"

# Create a list to store the results
$fileDetailsList = @()

# Read the CSV file into a PowerShell object
$fileDetailsList = Import-Csv -Path $csvFilePath

# Loop through each entry in the list
foreach ($fileDetails in $fileDetailsList) {
    $fileID = $fileDetails.FileID
    $filePath = Join-Path -Path $fileDetails.Folder -ChildPath $fileDetails.FileName
    $fileExists = Test-Path $filePath

    # Update the 'FileExists' value in the list
    if (-not $fileExists) {
        $fileDetails.FileExists = "N"
    }

    Write-Host "FileID: $fileID, FileExists: $($fileDetails.FileExists)"
}

# Optionally, update the SQL table with the new 'FileExists' values here
