# Define your SQL query
$sqlQuery = @"
SELECT 
	 FileID
	,'E' AS [Source]
	,Folder
	,[FileName]
	,CreatedDate
	,UpdatedDate
	,Supplieddate
	,FileSize,
	FileExists
FROM xxx sfd
WHERE FileExists = 'Y'
UNION
SELECT 
	 DataIn_FileId
	,'I' AS [Source]
	,Folder
	,[Filename]
	,CreatedDate
	,UpdatedDate
	,SuppliedDate
	,FileSize,
	FileExists
FROM yyy
WHERE FileExists = 'Y'
AND CHARINDEX('\CallTrace\', Folder) > 0
"@

# Set up the connection string (replace with your actual connection details)
$connectionString = "Server=YourServer;Database=YourDatabase;Integrated Security=True;"

# Run the SQL query and store the results in a variable
$results = Invoke-Sqlcmd -Query $sqlQuery -ConnectionString $connectionString

# Filter files based on SuppliedDate being after '2023-01-01'
$filteredFiles = $results | Where-Object { $_.SuppliedDate -gt '2023-01-01' }

# Display the filtered files
$filteredFiles | Format-Table -AutoSize
