function CreateDTPXML {
    param (
        [ref] [string] $GUID
    )

    # Create an XML Document object
    $xmlDoc = New-Object System.Xml.XmlDocument

    # Define XML structure components
    $doubleQuote = '"'

    $header = '<?xml version="1.0" encoding="utf-8"?>' + "`n"
    $header2 = "<Request>`n"

    $requiredNodes = "<Process ID=$doubleQuote$GUID$doubleQuote>"
    $requiredNodes += "<ProcessName />"
    $requiredNodes += "<Description />"
    $requiredNodes += "<ProcessPriority>50</ProcessPriority>"
    $requiredNodes += "<SuccessNotificationEmail>"
    $requiredNodes += "<To></To>"
    $requiredNodes += "<CC />"
    $requiredNodes += "<BCC />"
    $requiredNodes += "<Subject />"
    $requiredNodes += "<Message />"
    $requiredNodes += "</SuccessNotificationEmail>"
    $requiredNodes += "<ChangeHistory>"
    $requiredNodes += "<ChangeDescription />"
    $requiredNodes += "<ChangedBy />"
    $requiredNodes += "<ChangedDTS />"
    $requiredNodes += "</ChangeHistory>"
    $requiredNodes += "</Process>"

    $footer = "</Request>"

    # Combine all parts into one XML string
    $temporaryXML = $header + $header2 + $requiredNodes + $footer

    # Load the XML string into the XmlDocument object
    $null = $xmlDoc.LoadXml($temporaryXML)

    # Return the XML document
    return $xmlDoc
}
